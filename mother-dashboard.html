<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mother Dashboard</title>
    <style>
        /* Basic CSS Styling (Tailwind-like) */
        .container { padding: 20px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; }
        .form-group input, .form-group textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .btn { padding: 10px 15px; border: none; color: white; border-radius: 5px; cursor: pointer; }
        .btn-primary { background-color: #007bff; }
        .btn-success { background-color: #28a745; }
        .btn-danger { background-color: #dc3545; }
        .btn-warning { background-color: #ffc107; color: black; }
        .space-y-4 > * + * {
            margin-top: 1rem;
        }
        .shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
        }
        .rounded {
            border-radius: 0.25rem;
        }
        .w-full {
            width: 100%;
        }
        .bg-gray-200 {
            background-color: #edf2f7;
        }
        .text-red-500 {
            color: #e3342f;
        }
        .italic {
            font-style: italic;
        }
        .block {
            display: block;
        }
        .text-gray-700 {
            color: #4a5568;
        }
        .text-sm {
            font-size: 0.875rem;
        }
        .font-bold {
            font-weight: 700;
        }
        .mb-2 {
            margin-bottom: 0.5rem;
        }
        .capitalize {
            text-transform: capitalize;
        }
        .flex {
            display: flex;
        }
        .justify-between {
            justify-content: space-between;
        }
        .items-center {
            align-items: center;
        }
        .mt-4 {
            margin-top: 1rem;
        }
        .max-h-96 {
            max-height: 24rem; /* Equivalent to 96 in Tailwind's scaling */
        }
        .overflow-y-auto {
            overflow-y: auto;
        }
        .border {
            border-width: 1px;
            border-style: solid;
            border-color: #cbd5e0;
        }
        .p-4 {
            padding: 1rem;
        }
        .rounded-lg {
            border-radius: 0.5rem;
        }
        .inline-flex {
            display: inline-flex;
        }
        .h-5 {
            height: 1.25rem; /* Equivalent to 5 in Tailwind's scaling */
        }
        .w-5 {
            width: 1.25rem; /* Equivalent to 5 in Tailwind's scaling */
        }
        .text-blue-600 {
            color: #2563eb;
        }
        .ml-2 {
            margin-left: 0.5rem;
        }
        .px-6 {
            padding-left: 1.5rem; /* Equivalent to 6 in Tailwind's scaling */
            padding-right: 1.5rem; /* Equivalent to 6 in Tailwind's scaling */
        }
        .py-2 {
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
        }
        .font-semibold {
            font-weight: 600;
        }
        .text-white {
            color: #fff;
        }
        .transition {
            transition-property: all;
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
            transition-duration: 150ms;
        }
        .bg-blue-600 {
            background-color: #2563eb;
        }
        .hover\:bg-blue-700:hover {
            background-color: #1d4ed8;
        }
        .bg-gray-400 {
            background-color: #9ca3af;
        }
        .cursor-not-allowed {
            cursor: not-allowed;
        }
        .mb-4 {
            margin-bottom: 1rem;
        }
        .border-gray-300 {
            border-color: #d1d5db;
        }
        .p-2 {
            padding: 0.5rem;
        }
        .disabled\:bg-gray-400:disabled {
            background-color: #9ca3af;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Mother Dashboard</h1>

        <div id="dashboardContent" class="space-y-4">
            <!-- Content will be dynamically inserted here -->
        </div>
    </div>

    <script>
        const dashboardContent = document.getElementById('dashboardContent');

        let motherInfo = {};
        let isEditing = false;
        let activeStep = 0;
        let uploadedImages = [];
        let paymentScreenshot = "";
        let policyAccepted = false;
        let selectedImages = [];
        let imageUrls = [];
        let selectedPaymentImage = null;
        let paymentImageUrl = "";
        let detailsValidation = {};

        // Mock localStorage (replace with actual implementation if needed)
        const localStorageMock = {
            getItem: (key) => {
                if (key === 'userEmail') return 'test@example.com'; // Example email
                return null;
            },
            setItem: (key, value) => {
                // Store item
            },
            removeItem: (key) => {
                // Remove item
            }
        };

        // Fetch Mother Info (Mocked for demonstration)
        const fetchMotherInfo = async () => {
            const userEmail = localStorageMock.getItem("userEmail");
            if (userEmail) {
                // Simulated data (replace with actual API call)
                motherInfo = {
                    email: userEmail,
                    name: "Jane Doe",
                    age: 30,
                    weeksPregnant: 20,
                    currentWeight: "70kg",
                    dueDate: "2024-05-01",
                    consultingDoctor: "Dr. Smith",
                    hospitalName: "General Hospital",
                    conceivedThrough: "Natural",
                    IVF_IUI: "No",
                    phoneNumber: "123-456-7890",
                    joiningDate: "2023-08-01",
                    programName: "Prenatal Program",
                    classMode: "Online",
                    classTime: "10:00 AM",
                    medicalCondition: "None",
                    policyAccepted: false
                };
                policyAccepted = motherInfo.policyAccepted || false;
                renderStep(activeStep);
            }
        };

        const handleEditToggle = () => {
            isEditing = !isEditing;
            renderStep(activeStep);
        };

        const handleChange = (e) => {
            const { name, value } = e.target;
            motherInfo = { ...motherInfo, [name]: value };
            detailsValidation = {
                ...detailsValidation,
                [name]: value ? "" : "This field is required"
            };
            renderStep(activeStep);
        };

        const handleUpdate = async (e) => {
            e.preventDefault();
            // In a real scenario, you would send this data to your server
            console.log("Updating mother information:", motherInfo);
            isEditing = false;
             renderStep(activeStep);
            alert("Mother information updated successfully!"); // Mock success message
        };

         const handleImageChange = (event) => {
            const files = event.target.files;
            if (files) {
                selectedImages = Array.from(files);
            }
        };

        const handleUploadImages = async () => {
            if (selectedImages.length === 0) {
                alert("Please select images!");
                return;
            }

            const uploadedUrls = [];

            for (const image of selectedImages) {
                // Simulate upload to Cloudinary
                const imageUrl = URL.createObjectURL(image); // Create a temporary URL
                uploadedUrls.push(imageUrl);
                console.log(`Uploaded ${image.name} - URL: ${imageUrl}`);
            }

            imageUrls = uploadedUrls;
            uploadedImages = uploadedUrls;
            alert("Images uploaded successfully!");
        };

        const handlePaymentImageChange = (event) => {
            const files = event.target.files;
            if (files && files.length > 0) {
                selectedPaymentImage = files[0];
            }
        };

        const handleUploadPaymentScreenshot = async () => {
            if (!selectedPaymentImage) {
                alert("Please select an image!");
                return;
            }
           const imageUrl = URL.createObjectURL(selectedPaymentImage);

            paymentImageUrl = imageUrl;
            paymentScreenshot = imageUrl;
            alert("Payment screenshot uploaded successfully!");
        };


        const handlePolicyAcceptance = (accepted) => {
            policyAccepted = accepted;
        };

        const validateDetails = () => {
            const errors = {};
            if (!motherInfo?.name) errors.name = "This field is required";
            if (!motherInfo?.age) errors.age = "This field is required";

            detailsValidation = errors;
            return Object.keys(errors).length === 0;
        };

        const handleNext = () => {
            if (activeStep === 0) {
                if (!validateDetails()) {
                    alert("Please fill in all the required details.");
                    return;
                }
            }
            if (activeStep === 1) {
                 if (!policyAccepted) {
                    alert("Please accept the policy to proceed.");
                    return;
                }
            }

            activeStep++;
            renderStep(activeStep);
        };

        const policyContent = `
            Our Prenatal or Postnatal Fitness Classes are scheduled in the interest of the Instructor.
            No PAID or FREE TRIAL classes are offered by AURA.
            There is no pay per class policy. Payment is considered for the month & number of sessions per month.
            Fees have to be paid in advance by the due date of the 1st of every month without fail.
            No partial Payment is allowed.
            Fees once paid cannot be refunded, compensated with different classes, or transferred.
            The Educator reserves the right to change the particular class as and when the need arises.
            Classes missed by the Clients cannot be compensated, refunded, or carried forward by the Client.
            Time is Precious. Allow yourself to be on time. If the practitioner fails to turn up within 15 minutes of the session, the class is considered as a miss from the client’s end. No waiting, please.
            The photos and videos of the practitioners/clients taken by the Educator during the class can be used on social media for inspiration and to promote Prenatal care services.
            Class Video Recordings are only shared if informed prior but no more than 3 sessions max in a month.
            Aura reserves the right to decide how much of the content video can be shared with the client.
            The recordings are shared ONLY for the personal practice of the client if the client misses the session.
            Do not violate the rule of sharing the recordings with anyone.
            Aura reserves the right to take strict legal action if the video recordings shared by the Educator are found with anyone else or on any media platforms apart from the client.
            Aura holds the copyright towards any class recordings and class structure.

            AGREEMENT OF RELEASE & WAIVER OF LIABILITY FORM

            I, ${motherInfo?.name || ""}, hereby agree to the following:
            That I am participating in the Prenatal / Postnatal Fitness classes offered by Aura Birthing Partner during which I will receive information and instructions about fitness classes. I recognize that they may require some physical exertion, which may be strenuous and may cause physical injury, and I am fully aware of the risks and hazards involved. In consideration of being permitted to participate in the class, I agree to assume full responsibility for any risks, injuries, or damages, known or unknown, which I might incur as a result of participating in the program.

            In further consideration of being permitted to participate in the class, I knowingly, voluntarily, and expressly waive any claim I may have against the Instructor for any injury or damage that I may sustain as a result of participating in the program.

            I, my heirs or legal representatives, forever release, waive, discharge, and covenant negligence or other acts. I have read the above release and waiver of liability and fully understand its contents as well as the general terms and conditions of admission. I voluntarily agree to the terms and conditions stated above.
        `;

        const renderStep = (step) => {
            let content = '';

            if (step === 0) {
                content = renderMotherInfoForm();
            } else if (step === 1) {
                content = renderPolicyAgreement();
            } else if (step === 2) {
                content = renderImageUpload();
            } else if (step === 3) {
                content = renderPaymentScreenshotUpload();
            } else {
                content = '<p>All steps completed!</p>';
            }

            dashboardContent.innerHTML = content;
        };

        const renderMotherInfoForm = () => {
            let formContent = '';
            Object.keys(motherInfo)
                .filter(field => field !== "uploadedImages" && field !== "paymentScreenshot")
                .forEach(field => {
                    formContent += `
                        <div class="form-group">
                            <label for="${field}" class="block text-gray-700 text-sm font-bold mb-2 capitalize">${field.replace(/([A-Z])/g, ' $1')}:</label>
                            <input
                                type="${field === 'joiningDate' ? 'date' : (field === 'age' || field === 'weeksPregnant' || field === 'currentWeight') ? 'number' : 'text'}"
                                id="${field}"
                                name="${field}"
                                value="${motherInfo[field] || ''}"
                                onchange="handleChange(event)"
                                ${field === 'email' || !isEditing ? 'disabled' : ''}
                                class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline ${!isEditing || field === 'email' ? 'bg-gray-200' : ''}"
                                required="${field !== 'email'}"
                            />
                            ${detailsValidation[field] ? `<p class="text-red-500 text-xs italic">${detailsValidation[field]}</p>` : ''}
                        </div>
                    `;
                });

            let buttons = isEditing ? `
                <button class="btn btn-primary" onclick="handleUpdate(event)">Update Information</button>
                <button class="btn btn-danger" onclick="handleEditToggle()">Cancel</button>
            ` : `
                <button class="btn btn-warning" onclick="handleEditToggle()">Edit Information</button>
            `;

            return `
                <form class="space-y-4">
                    ${formContent}
                    <div class="flex justify-between">
                        ${buttons}
                         ${isEditing ? '':  `<button class="btn btn-primary" onclick="handleNext()">Next</button>`}
                    </div>
                </form>
            `;
        };

        const renderPolicyAgreement = () => {
            return `
                <div class="space-y-4">
                    <h2 class="text-xl font-semibold mb-2">Policy Agreement</h2>
                    <div class="border p-4 rounded-lg max-h-96 overflow-y-auto">
                        <p style="white-space: pre-line;">${policyContent}</p>
                    </div>
                    <div class="flex items-center justify-between mt-4">
                        <label class="inline-flex items-center">
                            <input type="checkbox" class="form-checkbox h-5 w-5 text-blue-600"
                                   ${policyAccepted ? 'checked' : ''}
                                   onchange="policyAccepted = !policyAccepted; handlePolicyAcceptance(policyAccepted); renderStep(1);" />
                            <span class="ml-2 text-gray-700">I accept the Policy</span>
                        </label>
                        <button
                            class="px-6 py-2 rounded-lg font-semibold text-white transition ${policyAccepted ? 'bg-blue-600 hover:bg-blue-700' : 'bg-gray-400 cursor-not-allowed'}"
                            onclick="handleNext()"
                            ${!policyAccepted ? 'disabled' : ''}>
                            Next
                        </button>
                    </div>
                </div>
            `;
        };

        const renderImageUpload = () => {
            return `
                <div class="space-y-4">
                    <h2 class="text-xl font-semibold">Upload your First Medical Scan Reports and your Recent Medical Scan Reports</h2>
                    <p>(Max upload of 4 Images , no pdfs )</p>
                    <input type="file" multiple accept="image/*" onchange="handleImageChange(event)" class="mb-4 border border-gray-300 p-2 rounded" />
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded disabled:bg-gray-400"
                            onclick="handleUploadImages()" ${selectedImages.length === 0 ? 'disabled' : ''}>
                        Upload Images
                    </button>
                    ${imageUrls.map(url => `<img src="${url}" alt="Uploaded Image" style="max-width: 200px; margin-top: 10px;">`).join('')}
                     <button class="btn btn-primary" onclick="handleNext()">Next</button>
                </div>
            `;
        };

        const renderPaymentScreenshotUpload = () => {
            return `
                <div class="space-y-4">
                    <h2 class="text-xl font-semibold">Upload Payment Screenshot</h2>
                    <input type="file" accept="image/*" onchange="handlePaymentImageChange(event)" class="mb-4 border border-gray-300 p-2 rounded" />
                    <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded disabled:bg-gray-400"
                            onclick="handleUploadPaymentScreenshot()" ${!selectedPaymentImage ? 'disabled' : ''}>
                        Upload Payment Screenshot
                    </button>
                    ${paymentImageUrl ? `<img src="${paymentImageUrl}" alt="Payment Screenshot" style="max-width: 200px; margin-top: 10px;">` : ''}
                </div>
            `;
        };

        // Initial render
        fetchMotherInfo();
    </script>
</body>
</html>
